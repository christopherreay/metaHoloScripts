groupName=$1
chainName=$2
instanceNumber=$3
bootstrapPort=$4
internalPort=$5
externalPort=$6

chainID=$groupName$chainName$instanceNumber
groupDir=groupGithubs/$groupName


echo "cloning $chainName to $chainID"
hc clone groupGithubs/$groupName/$chainName $chainID

Scripts/hc.rewrite.confFile $chainID $bootstrapPort $internalPort

hc status

echo "genesis of $chainID"
hc gen chain $chainID

hc status

echo "rewritten chain template"
cat .holochain/$chainID/config.toml

echo "$(date +%s) server restarted"
hc serve $chainID $externalPort 2>&1 | tee -a $groupDir/logs/$chainName.log >> $groupDir/logs/allServers.log &
